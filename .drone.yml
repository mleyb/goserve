workspace:
  base: /go
  path: src/github.com/mleyb/goserve

pipeline:
  test:
    image: golang:latest
    commands:
      - go get
      - go vet
      - go test -v -cover
  build:
    image: golang:latest
    commands:
      - go get
      - go build
  docker-build:
    image: docker
    commands:
      - docker build --build-arg VCS_REF=DRONE_COMMIT --build-arg VCS_URL="https://github.com/mleyb/goserve" .
